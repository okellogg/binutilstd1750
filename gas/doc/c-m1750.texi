@c Copyright (C) 1991, 92, 93, 94, 95, 1996 Free Software Foundation, Inc.
@c This is part of the GAS manual.
@c For copying conditions, see the file as.texinfo.
@ifset GENERIC
@page
@node M1750-Dependent
@chapter MIL-STD-1750 Dependent Features
@end ifset
@ifclear GENERIC
@node Machine Dependencies
@chapter MIL-STD-1750 Dependent Features
@end ifclear

@cindex MIL-STD-1750 support
@menu
* M1750-Opts::                   M1750 Options
* M1750-Syntax::                 Syntax
* M1750-Float::                  Floating Point
* M1750-Directives::             1750 Machine Directives
* M1750-opcodes::                Opcodes
@end menu

@node M1750-Opts
@section M1750 Options

@cindex options, M1750
@cindex M1750 options
The MIL-STD-1750 version of @code{@value{AS}} has a few machine
dependent options.

@cindex @samp{-l} option, M1750


@cindex @samp{-A1750a} and related options
@cindex architecture options, M1750
@cindex M1750 architecture options
@code{@value{AS}} can assemble code for several different members of the
MIL-STD-1750A/B family.  The default depends upon how @code{@value{AS}}
was configured when it was built; normally, the default is to assemble
code for the 1750A.  The following options may be used to
change the default.  These options control which instructions and
addressing modes are permitted.  The members of the MIL-STD-1750 family are
very similar.  For detailed information about the differences, see 
MIL-STD-1750B, or 1750 vendor's literature.

@table @samp
@item -A1750a
Assemble for the 1750a with no expanded memory. (the default)

@item -A1750b
Assemble for the 1750b with all instruction options but no expanded memory.

@item -Ama31750
Assemble for the GEC-Plessey MA31750 in 1750B mode.

@item -Amas281
Assemble for the GEC-Plessey MAS281 or McDonnell Douglas MDC281.

@item -Ammu
Support expanded memory.

@item -Ano-mmu
Do not support expanded memory.

@item -Ab1
Permit 1750B optional mathematical instructions.

@item -Ab2
Permit 1750B optional long loads and stores.

@item -Ab3
Permit 1750B optional unsigned arithmetic and load and store byte instructions.

@item -Ano-b1
Reject 1750B optional mathematical instructions.

@item -Ano-b2
Reject 1750B optional long loads and stores.

@item -Ano-b3
Reject 1750B optional unsigned arithmetic and load and store byte instructions.

@end table

@node M1750-Syntax
@section Syntax

@cindex M1750 syntax
@cindex syntax, M1750
The MIL-STD-1750 version of @code{@value{AS}} uses instructions names and
syntax as defined in the standard. Directives follow the @code{@value{AS}} conventions. 

@cindex M1750 register names
The names of the registers are: r0, r1, r2, r3, r4, r5, r6, r7, r8. r9, r10, r11, 
r12, r13, r14, r15. The assembler also accepts an upper case letter R. The registers r1 to r15 
may be used as index registers. The registers r12 to r15 may be used as base registers.

@cindex M1750 addressing modes
@cindex addressing modes, M1750
The following addressing modes are understood. Note that address will be converted
into word adddesses when used in an instruction.


@table @dfn

@item Register Direct
@samp{lr     @var{register},@var{register}}

@item Memory Direct
@samp{l      @var{word-address}}

@item Memory Direct Indexed
@samp{l      @var{word-address},@var{index-register}}

@item Memory Indirect 
@samp{li     @var{address}}

@item Memory Indirect with Pre-Indexing
@samp{li     @var{word-address},@var{index-register}}

@item Immediate Long
@samp{lim    @var{number}} 

@item Immediate Short Positive
@samp{lisp   @var{short-number}}

@item Immediate Short Negative
@samp{lisn   @var{short-number}}

@item Instruction Counter Relative
@samp{br     @var{word-displacement}}

@item Base Relative 
@samp{lb     @var{base-register},@var{offset}}

@item Base Relative Indexed 
@samp{lb     @var{base-register},@var{offset},@var{index-register}}

@item Special
@samp{nop}

@end table

@node M1750-Float
@section Floating Point

@cindex floating point, M1750
@cindex M1750 floating point
The floating and fixed point formats generated by directives are these.

@table @code
@cindex @code{float} directive, M1750
@item .float
@code{Single} precision floating point constants (See MIL-STD-1750A section 4.1.5).

@cindex @code{double} directive, M1750
@item .double
@code{Double} precision floating point constants (See MIL-STD-1750A section 4.1.6).

@end table

@node M1750-Directives
@section M1750 Machine Directives

@cindex M1750 directives
@cindex directives, M1750

@menu
* M1750-skip::                         .skip
* M1750-rdata::                        .rdata
* M1750-rodata::                       .rodata
* M1750-sbam::                         .sbam
* M1750-dbam::                         .dbam
@end menu

@node M1750-skip
@subsection @code{.skip @var{number}}
@cindex @code{skip} directive
@cindex string literals
@code{.skip} is indentical to the @code{.space} directive.

@node M1750-rdata
@subsection @code{.rdata @var{subsection}}

@cindex @code{rdata} directive
@code{.rdata} tells @code{@value{AS}} to assemble the following statements onto the
end of the read-only data subsection numbered @var{subsection} (which is an
absolute expression).  If @var{subsection} is omitted, it defaults
to zero.

@node M1750-rodata
@subsection @code{.rodata @var{subsection}}

@cindex @code{rodata} directive
@code{.rdata} is identical to a @code{.rdata} directive.

@node M1750-sbam
@subsection @code{.sbam @var{flonums}}

@cindex @code{sbam} directive
@cindex fixed point numbers (single)
@code{.sbam} expects one or more flonums, separated by commas.  It
assembles @code{Single} precision binary angular measurement (See MIL-STD-1750B section 4.1.11).

@node M1750-dbam
@subsection @code{.dbam @var{flonums}}

@cindex @code{dbam} directive
@cindex fixed point numbers (double)
@code{.dbam} expects one or more flonums, separated by commas.  It
assembles @code{Double} precision binary angular measurement (See MIL-STD-1750B section 4.1.12).

@node M1750-opcodes
@section Opcodes

index M1750 opcodes
index opcodes, M1750
index instruction set, M1750

@menu
* M1750-eflr::                   Extended Floating Load register
* M1750-x::                      Expanded Memory Support
* M1750-Branch::                 Branch Improvement
* M1750-XIO::                    XIO Commands
* M1750-Chars::                  Special Characters
@end menu

@node M1750-eflr
@subsection Extended Floating Load Register

The 1750 does not have the important load register instruction for extended
precision floating point. The reason is we can copy a 3-word extended floating
point value from one triple register to another using a single load register
and a double load register. However if the source triple and destination triples
overlap, then it is important to get the single and double load in the correct
order otherwise the source will be overwritten before it is completely copied.

The opcode "eflr" is translated by the assembler into either a single load followed
by a double load, or a double load followed by a single load, depending on which
registers are used, and guarantees correct operation.

Note that the condition codes will not be correctly set by eflr. To set the
condition codes you should do an extended compare with zero. Of course to 
check whether a number is negative or not, no matter whether it is a 16 bit,
32 bit or 48 bit, fixed or floating, you only have to test the sign bit of the first word.

@node M1750-x
@subsection Expanded Memory Support

@cindex pseudo-opcodes, M1750
@cindex M1750 pseudo-opcodes
@cindex expanded memory, M1750
@cindex M1750 expanded memory 

There are two macro-like instructions, LSJS and LURS, for supporting subprogram call and return
across address states. Normally these will be translated by the assembler into
SJS and URS instructions, but if the assembler is run with the expanded memory option @code{-Ammu}
then LSJS is expended into an sequence of instructions that makes a call to a subprogram that
may be in a different address state. The LURS instruction is converted into a LST instruction,
using the register given in the LURS instruction (usually R15), and an offset of zero.
 

@node M1750-Branch
@subsection Branch Improvement

@cindex pseudo-opcodes, M1750
@cindex M1750 pseudo-opcodes
@cindex branch improvement, M1750
@cindex M1750 branch improvement
Certain pseudo opcodes are permitted for branch instructions.
They expand to the shortest branch instruction that reach the
target.  Generally these mnemonics are made by substituting @samp{j} for
@samp{b} at the start of a 1750 mnemonic.

The following table summarizes the pseudo-operations. 

@smallexample
+-----------+----------+--------------+
| Pseudo    |    Instruction size     |
| Op        | 16 bits  |  32 bits     |
+-----------+----------+--------------+
| j    L1   | br   L1  |  jc   uc,L1  |
| jeq  L1   | beq  L1  |  jc   eq,L1  |
| jne  L1   | bne  L1  |  jc   ne,L1  |
| jgt  L1   | bgt  L1  |  jc   gt,L1  | 
| jlt  L1   | blt  L1  |  jc   lt,L1  |
| jge  L1   | bge  L1  |  jc   ge,L1  |
| jle  L1   | ble  L1  |  jc   le,L1  | 
+-----------+----------+--------------+
@end smallexample

@node M1750-XIO
@subsection XIO Commands
@cindex XIO commands
All the MIL-STD-1750A and 1750B XIO commands are supported.

  BIT, CC, CI, CLC, CLIR, CO, DMAD, DMAE, DSBL, DSUR, 
  ENBL, ESUR, GO, ICW, ITA, ITAR, ITB, ITBR, ITGI, LMP, 
  LOS, LXMP, MPEN, OD, OTA, OTAR, OTB, OTBR, OTGR, PI, 
  PO, RCFR, RCS, RCW, RDI, RDOR, RDOW, RFMK, RFR, RIC1, 
  RIC2, RIPR, RLP, RMFA, RMFP, RMFS, RMK, RMP, RNS, ROPR, 
  ROS, RPBS, RPI, RPIR, RPS, RSW, RXMP, SFMK, SFR, SMK, 
  SPI, TAH, TAS, TBH, TBS, TPIO, WIPR, WOPR, WPBS, WSW

@node M1750-Chars
@subsection Special Characters

@cindex special characters, M1750
@cindex M1750 immediate character
@cindex immediate character, M1750
@cindex M1750 line comment character
@cindex line comment character, M1750
@cindex comments, M1750
The
line-comment character is @samp{!}.  If a @samp{#} appears at the beginning of a line, it
is treated as a comment unless it looks like @samp{# line file}, in
which case it is treated normally.

